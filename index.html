<!DOCTYPE html>
 <html lang="ro">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="black"/>
    <title>Lybra</title>
    <link rel="icon" sizes="192x192" href="icon.png">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="ios-icon.png">
    <link rel="stylesheet" type="text/css" href="styles.css" media="all">
    <link rel="stylesheet" type="text/css" href="/fonts/style.css" media="all">
    <link rel="shortcut icon" type="image/png" href="/icons/favicon.png"/>
  </head>
  <body>
    <div><h1 class="vertical-container"><span>Lybra</span></h1></div>
    <div class="spacer">
      <h2>Lybra, Singurul serviciu in care trebuie sa ai incredere.</h2>
    </div>
    <p></p>
    <div class="spacer">
      <h2>Acum si aplicatii!</h1>
      <p>Acum, Lybra are si o sectiune dedicata aplicatiilor! De ce sa nu o descoperi acum?</p>
      <div align="right">
        <button onclick="location.href='/aplicatii'" value="Verifica!"> Aplicatii </button>
      </div>
    </div>
  </body>
</center>
<!-- Service worker req -->
<script>
     if('serviceWorker' in navigator) {
       navigator.serviceWorker.register('sw.js')
         .then(function() {
               console.log('Service Worker Registered');
         });
     }
   </script>
   <script>
      const messaging = firebase.messaging();
      messaging.requestPermission()
      .then(function() {
        console.log('Notification permission granted.');
        return messaging.getToken();
      })
      .then(function(token) {
        console.log(token);
      })
      .catch(function(err) {
        console.log('Unable to get permission to notify.', err);
      })
    </script>
    <script>
    window.isUpdateAvailable = new Promise(function(resolve, reject) {
	if ('serviceWorker' in navigator && ['localhost', '127'].indexOf(location.hostname) === -1) {
		navigator.serviceWorker.register('sw.js')
			.then(reg => {
				reg.onupdatefound = () => {
					const installingWorker = reg.installing;
					installingWorker.onstatechange = () => {
						switch (installingWorker.state) {
							case 'installed':
								if (navigator.serviceWorker.controller) {
									resolve(true);
								} else {
									resolve(false);
								}
								break;
						}
					};
				};
			})
			.catch(err => console.error('[SW ERROR]', err));
	}
});
</script>
<script>
window['isUpdateAvailable']
	.then(isAvailable => {
		if (isAvailable) {
			const toast = this.toastCtrl.create({
				message: 'New Update available! Reload the webapp to see the latest juicy changes.',
				position: 'bottom',
				showCloseButton: true,
			});
			toast.present();
		}
	});
  </script>
</html>
